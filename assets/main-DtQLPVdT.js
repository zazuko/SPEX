import{q as c}from"./index-RSd0p-ZE.js";const u=c;class p extends u.Readable{constructor(e={}){if(super(e),e.iterator)throw new Error("readable stream iterator shortcut not yet implemented")}until(e,s){return new Promise((i,n)=>{this.on("error",t=>{n(t)}),s?this.once(e,(...t)=>{i(this,...t)}):this.once(e,i)})}bucket(e="utf8"){if(this._readableState.objectMode)return new Promise((i,n)=>{let t=[];this.pipe(new u.Writable({write(r,o,a){t.push(r),a()},writev(r,o){t.push(...r),o()}})).on("error",r=>{n(r)}).on("finish",()=>{i(t)})});if(e==="utf8"||e==="utf-8")return new Promise((i,n)=>{let t="";this.setEncoding(e),this.pipe(new u.Writable({decodeStrings:!1,write(r,o,a){t+=r,a()},writev(r,o){t+=r.join(""),o()}})).on("error",r=>{n(r)}).on("finish",()=>{i(t)})});if(e==="buffer")return new Promise((i,n)=>{let t=Buffer.from([]);this.pipe(new u.Writable({decodeStrings:!0,write(r,o,a){t=Buffer.concat([t,r],t.length+r.length),a()}})).on("error",r=>{n(r)}).on("finish",()=>{i(t)})})}}class w extends u.Writable{until(e,s){return new Promise((i,n)=>{this.on("error",t=>{n(t)}),s?this.once(e,(...t)=>{i(this,...t)}):this.once(e,i)})}import(e){return e.on("data",s=>this.write(s)).on("end",()=>this.end()).on("error",s=>this.emit("error",s)),this}}class h extends u.Duplex{until(e,s){return new Promise((i,n)=>{this.on("error",t=>{n(t)}),s?this.once(e,(...t)=>{i(this,...t)}):this.once(e,i)})}bucket(e="utf8"){if(this._readableState.objectMode)return new Promise((i,n)=>{let t=[];this.pipe(new u.Writable({write(r,o,a){t.push(r),a()},writev(r,o){t.push(...r),o()}})).on("error",r=>{n(r)}).on("finish",()=>{i(t)})});if(e==="utf8"||e==="utf-8")return new Promise((i,n)=>{let t="";this.setEncoding(e),this.pipe(new u.Writable({decodeStrings:!1,write(r,o,a){t+=r,a()},writev(r,o){t+=r.join(""),o()}})).on("error",r=>{n(r)}).on("finish",()=>{i(t)})});if(e==="buffer")return new Promise((i,n)=>{let t=Buffer.from([]);this.pipe(new u.Writable({decodeStrings:!0,write(r,o,a){t=Buffer.concat([t,r],t.length+r.length),a()}})).on("error",r=>{n(r)}).on("finish",()=>{i(t)})})}}class f extends u.Transform{until(e,s){return new Promise((i,n)=>{this.on("error",t=>{n(t)}),s?this.once(e,(...t)=>{i(this,...t)}):this.once(e,i)})}bucket(e="utf8"){if(this._readableState.objectMode)return new Promise((i,n)=>{let t=[];this.pipe(new u.Writable({write(r,o,a){t.push(r),a()},writev(r,o){t.push(...r),o()}})).on("error",r=>{n(r)}).on("finish",()=>{i(t)})});if(e==="utf8"||e==="utf-8")return new Promise((i,n)=>{let t="";this.setEncoding(e),this.pipe(new u.Writable({decodeStrings:!1,write(r,o,a){t+=r,a()},writev(r,o){t+=r.join(""),o()}})).on("error",r=>{n(r)}).on("finish",()=>{i(t)})});if(e==="buffer")return new Promise((i,n)=>{let t=Buffer.from([]);this.pipe(new u.Writable({decodeStrings:!0,write(r,o,a){t=Buffer.concat([t,r],t.length+r.length),a()}})).on("error",r=>{n(r)}).on("finish",()=>{i(t)})})}import(e){return e.on("data",s=>this.write(s)).on("end",()=>this.end()).on("error",s=>this.emit("error",s)),this}demolish(e){if(this.push=s=>{if(s!==null)throw new Error("[ERR_STREAM_DESTROYED]: Cannot push after stream was destroyed")},this.emit=function(s,...i){s!=="end"&&Object.getPrototypeOf(this).emit.apply(this,[s,...i])},e)return u.Transform.prototype.destroy.call(this,e)}}const m=new Function("try {return this===global;}catch(e){return false;}")(),[y,b]=typeof process>"u"?[!0,!1]:process.browser?[!0,!0]:process.versions==="undefined"||process.versions.node==="undefined"?[!0,!1]:[!1,!1];(b||m&&+/^v(\d+)/.exec(process.version)[1]<10)&&(f.prototype.destroy=h.prototype.destroy=function(l,e){this._readableState.destroyed=!0,this._writableState.destroyed=!0;let s=()=>{this._writableState.emitClose&&this._readableState.emitClose&&this.emit("close")};return this._destroy(l||null,i=>{!e&&i?(process.nextTick(()=>{this.emit("error",i),s()}),this._writableState.errorEmitted=!0):(process.nextTick(s),e&&e(i))}),this},f.prototype._destroy=h.prototype._destroy=(l,e)=>e(l));class d extends f{constructor(e={}){super({...e,writableObjectMode:!0,readableObjectMode:!0}),this._as_inputs=new Set,this.on("pipe",s=>{this._as_inputs.add(s),s.on("prefix",(...i)=>{this.emit("prefix",...i)}).on("comment",(...i)=>{this.emit("comment",...i)})}),this.on("unpipe",s=>{this._as_inputs.delete(s)})}_destroy(){for(let e of this._as_inputs)e.destroy()}}class _ extends d{_transform(e,s,i){i(null,JSON.stringify(e.isolate())+`
`)}}class g extends d{_transform(e,s,i){i(null,{type:"quad",value:e})}}f.QuadsToOther=d;var x={...u,Readable:p,Writable:w,Duplex:h,Transform:f,QuadsToOther:d,quads_to_json(){return new _},quads_to_writable(){return new g},source(l,e=null){return!e&&typeof l=="string"&&(e="utf8"),new p({objectMode:!e&&typeof l!="string"&&!Buffer.isBuffer(l),read(){this.push(l,e),this.push(null)}})}};export{x as m};
