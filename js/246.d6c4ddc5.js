(self["webpackChunk_zazuko_spex"]=self["webpackChunk_zazuko_spex"]||[]).push([[246],{84905:function(t,e,n){const r=n(13767);t.exports=r},77762:function(t){class e{constructor(t){this.value=t||"b"+ ++e.nextId}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value}}e.prototype.termType="BlankNode",e.nextId=0,t.exports=e},13767:function(t,e,n){const r=n(77762),a=n(59060),i=n(95170),s=n(44591),o=n(12591),l=n(73669),d=n(58987);function c(t){return new o(t)}function u(t){return new r(t)}function h(t,e){return"string"===typeof e?-1===e.indexOf(":")?new s(t,e):new s(t,null,x.namedNode(e)):new s(t,null,e)}function p(t){return new d(t)}function f(){return x.defaultGraphInstance}function g(t,e,n){return x.quad(t,e,n)}function y(t,e,n,r){return new l(t,e,n,r||x.defaultGraphInstance)}function C(t){return i.call(x,t)}function w(t){return i.call(x,t)}const x={namedNode:c,blankNode:u,literal:h,variable:p,defaultGraph:f,triple:g,quad:y,fromTerm:C,fromQuad:w,defaultGraphInstance:new a};t.exports=x},59060:function(t){class e{equals(t){return!!t&&t.termType===this.termType}}e.prototype.termType="DefaultGraph",e.prototype.value="",t.exports=e},44591:function(t,e,n){const r=n(12591);class a{constructor(t,e,n){this.value=t,this.datatype=a.stringDatatype,this.language="",e?(this.language=e,this.datatype=a.langStringDatatype):n&&(this.datatype=n)}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value&&t.language===this.language&&t.datatype.equals(this.datatype)}}a.prototype.termType="Literal",a.langStringDatatype=new r("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),a.stringDatatype=new r("http://www.w3.org/2001/XMLSchema#string"),t.exports=a},12591:function(t){class e{constructor(t){this.value=t}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value}}e.prototype.termType="NamedNode",t.exports=e},73669:function(t,e,n){const r=n(59060);class a{constructor(t,e,n,a){this.subject=t,this.predicate=e,this.object=n,this.graph=a||new r}equals(t){return!!t&&("Quad"===t.termType||!t.termType)&&t.subject.equals(this.subject)&&t.predicate.equals(this.predicate)&&t.object.equals(this.object)&&t.graph.equals(this.graph)}}a.prototype.termType="Quad",a.prototype.value="",t.exports=a},58987:function(t){class e{constructor(t){this.value=t}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value}}e.prototype.termType="Variable",t.exports=e},95170:function(t){function e(t){if(!t)return null;if("BlankNode"===t.termType)return this.blankNode(t.value);if("DefaultGraph"===t.termType)return this.defaultGraph();if("Literal"===t.termType)return this.literal(t.value,t.language||this.namedNode(t.datatype.value));if("NamedNode"===t.termType)return this.namedNode(t.value);if("Quad"===t.termType){const e=this.fromTerm(t.subject),n=this.fromTerm(t.predicate),r=this.fromTerm(t.object),a=this.fromTerm(t.graph);return this.quad(e,n,r,a)}if("Variable"===t.termType)return this.variable(t.value);throw new Error(`unknown termType ${t.termType}`)}t.exports=e},94246:function(t,e,n){const r=n(95883),a=n(63589);class i extends r{constructor(t){super(a,t)}}t.exports=i},63589:function(t,e,n){const r=n(84905),{JsonLdParser:a}=n(30649),{Transform:i}=n(88473),s="null:";function o(t){return e=>"NamedNode"!==e.termType?null:e.value.startsWith(s)?t.namedNode(e.value.slice(s.length)):null}function l(t){const e=o(t);return n=>{const r=e(n.subject),a=e(n.predicate),i=e(n.object),s=e(n.graph);return r||a||i||s?t.quad(r||n.subject,a||n.predicate,i||n.object,s||n.graph):n}}class d{constructor(t,{baseIRI:e=s,context:n=null,factory:o=r}={}){const d=new a({baseIRI:e,context:n,dataFactory:o,streamingProfile:!1});t.pipe(d);const c=l(o),u=new i({objectMode:!0,transform:(t,e,n)=>{n(null,c(t))}});return d.on("context",(t=>{Object.entries(t).forEach((([t,e])=>{u.emit("prefix",t,o.namedNode(e))}))})),d.on("error",(t=>u.destroy(t))),d.pipe(u),u}}t.exports=d},95883:function(t){class e{constructor(t,e){this.Impl=t,this.options=e}import(t,e){const n=new this.Impl(t,Object.assign({},this.options,e));return t.on("end",(()=>{n.readable||n.emit("end")})),t.on("error",(t=>{n.emit("error",t)})),n}}t.exports=e},30649:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),a(n(99333),e)},31434:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContextTree=void 0;class n{constructor(){this.subTrees={}}getContext(t){if(t.length>0){const[e,...n]=t,r=this.subTrees[e];if(r){const t=r.getContext(n);if(t)return t.then((({context:t,depth:e})=>({context:t,depth:e+1})))}}return this.context?this.context.then((t=>({context:t,depth:0}))):null}setContext(t,e){if(0===t.length)this.context=e;else{const[r,...a]=t;let i=this.subTrees[r];i||(i=this.subTrees[r]=new n),i.setContext(a,e)}}removeContext(t){this.setContext(t,null)}}e.ContextTree=n},99333:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JsonLdParser=void 0;const r=n(2222),a=n(11288),i=n(42830),s=n(27765),o=n(52780),l=n(52234),d=n(37930),c=n(70983),u=n(42397),h=n(96700),p=n(26664),f=n(84149),g=n(46100),y=n(65457),C=n(18896),w=n(82962),x=n(44360),E=n(12475);class m extends i.Transform{constructor(t){super({readableObjectMode:!0}),t=t||{},this.options=t,this.parsingContext=new w.ParsingContext(Object.assign({parser:this},t)),this.util=new x.Util({dataFactory:t.dataFactory,parsingContext:this.parsingContext}),this.jsonParser=new r,this.contextJobs=[],this.typeJobs=[],this.contextAwaitingJobs=[],this.lastDepth=0,this.lastKeys=[],this.lastOnValueJob=Promise.resolve(),this.attachJsonParserListeners(),this.on("end",(()=>{"undefined"!==typeof this.jsonParser.mode&&this.emit("error",new Error("Unclosed document"))}))}static fromHttpResponse(t,e,n,r){let i,s;if("application/ld+json"!==e){if("application/json"!==e&&!e.endsWith("+json"))throw new a.ErrorCoded(`Unsupported JSON-LD media type ${e}`,a.ERROR_CODES.LOADING_DOCUMENT_FAILED);if(n&&n.has("Link")&&n.forEach(((e,n)=>{if("link"===n){const n=E.parse(e);for(const e of n.get("rel","http://www.w3.org/ns/json-ld#context")){if(i)throw new a.ErrorCoded("Multiple JSON-LD context link headers were found on "+t,a.ERROR_CODES.MULTIPLE_CONTEXT_LINK_HEADERS);i=e.uri}}})),!i&&!(null===r||void 0===r?void 0:r.ignoreMissingContextLinkHeader))throw new a.ErrorCoded(`Missing context link header for media type ${e} on ${t}`,a.ERROR_CODES.LOADING_DOCUMENT_FAILED)}if(n&&n.has("Content-Type")){const t=n.get("Content-Type"),e=/; *profile=([^"]*)/.exec(t);e&&"http://www.w3.org/ns/json-ld#streaming"===e[1]&&(s=!0)}return new m(Object.assign({baseIRI:t,context:i,streamingProfile:s},r||{}))}import(t){const e=new i.PassThrough({readableObjectMode:!0});t.on("error",(t=>n.emit("error",t))),t.on("data",(t=>e.push(t))),t.on("end",(()=>e.push(null)));const n=e.pipe(new m(this.options));return n}_transform(t,e,n){this.jsonParser.write(t),this.lastOnValueJob.then((()=>n()),(t=>n(t)))}async newOnValueJob(t,e,n,r){let i=!0;if(r&&n<this.lastDepth){const t=this.parsingContext.listPointerStack[this.lastDepth];t&&(t.value&&this.emit("data",this.util.dataFactory.quad(t.value,this.util.rdfRest,this.util.rdfNil,this.util.getDefaultGraph())),t.listId.listHead=!0,this.parsingContext.idStack[t.listRootDepth+1]=[t.listId],this.parsingContext.listPointerStack.splice(this.lastDepth,1)),await o.EntryHandlerContainer.isBufferableContainerHandler(this.parsingContext,this.lastKeys,this.lastDepth)?(this.parsingContext.pendingContainerFlushBuffers.push({depth:this.lastDepth,keys:this.lastKeys.slice(0,this.lastKeys.length)}),i=!1):await this.flushBuffer(this.lastDepth,this.lastKeys)}const s=await this.util.unaliasKeyword(t[n],t,n),l=await this.util.unaliasKeywordParent(t,n);this.parsingContext.emittedStack[n]=!0;let d=!0;a.Util.isValidKeyword(s)&&"@reverse"===l&&"@context"!==s&&this.emit("error",new a.ErrorCoded(`Found the @id '${e}' inside an @reverse property`,a.ERROR_CODES.INVALID_REVERSE_PROPERTY_MAP));let c=!1;this.parsingContext.validationStack.length>1&&(c=this.parsingContext.validationStack[this.parsingContext.validationStack.length-1].property);for(let a=Math.max(1,this.parsingContext.validationStack.length-1);a<t.length-1;a++){const e=this.parsingContext.validationStack[a]||(this.parsingContext.validationStack[a]=await this.validateKey(t.slice(0,a+1),a,c));if(!e.valid){this.parsingContext.emittedStack[n]=!1,d=!1;break}!c&&e.property&&(c=!0)}if(this.util.isLiteral(n)&&(d=!1),d)for(const a of m.ENTRY_HANDLERS){const r=await a.test(this.parsingContext,this.util,s,t,n);if(r){await a.handle(this.parsingContext,this.util,s,t,e,n,r),a.isStackProcessor()&&(this.parsingContext.processingStack[n]=!0);break}}0===n&&Array.isArray(e)&&await this.util.validateValueIndexes(e),i&&n<this.lastDepth&&this.flushStacks(this.lastDepth),this.lastDepth=n,this.lastKeys=t,this.parsingContext.unaliasedKeywordCacheStack.splice(n-1)}flushStacks(t){this.parsingContext.processingStack.splice(t,1),this.parsingContext.processingType.splice(t,1),this.parsingContext.emittedStack.splice(t,1),this.parsingContext.idStack.splice(t,1),this.parsingContext.graphStack.splice(t+1,1),this.parsingContext.graphContainerTermStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1),this.parsingContext.validationStack.splice(t-1,2),this.parsingContext.literalStack.splice(t,this.parsingContext.literalStack.length-t)}async flushBuffer(t,e){let n=this.parsingContext.idStack[t];n||(n=this.parsingContext.idStack[t]=[this.util.dataFactory.blankNode()]);const r=this.parsingContext.unidentifiedValuesBuffer[t];if(r){for(const a of n){const n=await this.util.getDepthOffsetGraph(t,e),i=this.parsingContext.graphStack[t]||n>=0?this.parsingContext.idStack[t-n-1]:[await this.util.getGraphContainerValue(e,t)];if(i)for(const e of i){this.parsingContext.emittedStack[t]=!0;for(const n of r)n.reverse?this.parsingContext.emitQuad(t,this.util.dataFactory.quad(n.object,n.predicate,a,e)):this.parsingContext.emitQuad(t,this.util.dataFactory.quad(a,n.predicate,n.object,e))}else{const n=this.parsingContext.getUnidentifiedGraphBufferSafe(t-await this.util.getDepthOffsetGraph(t,e)-1);for(const t of r)t.reverse?n.push({object:a,predicate:t.predicate,subject:t.object}):n.push({object:t.object,predicate:t.predicate,subject:a})}}this.parsingContext.unidentifiedValuesBuffer.splice(t,1),this.parsingContext.literalStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1)}const a=this.parsingContext.unidentifiedGraphsBuffer[t];if(a){for(const e of n){const n=1!==t||"BlankNode"!==e.termType||this.parsingContext.topLevelProperties?e:this.util.getDefaultGraph();this.parsingContext.emittedStack[t]=!0;for(const e of a)this.parsingContext.emitQuad(t,this.util.dataFactory.quad(e.subject,e.predicate,e.object,n))}this.parsingContext.unidentifiedGraphsBuffer.splice(t,1)}}async validateKey(t,e,n){for(const r of m.ENTRY_HANDLERS)if(await r.validate(this.parsingContext,this.util,t,e,n))return{valid:!0,property:n||r.isPropertyHandler()};return{valid:!1,property:!1}}attachJsonParserListeners(){this.jsonParser.onValue=t=>{const e=this.jsonParser.stack.length,n=new Array(e+1).fill(0).map(((t,n)=>n===e?this.jsonParser.key:this.jsonParser.stack[n].key));if(!this.isParsingContextInner(e)){const r=()=>this.newOnValueJob(n,t,e,!0);if(this.parsingContext.streamingProfile||this.parsingContext.contextTree.getContext(n.slice(0,-1)))this.lastOnValueJob=this.lastOnValueJob.then(r);else if("@context"===n[e]){let t=this.contextJobs[e];t||(t=this.contextJobs[e]=[]),t.push(r)}else"@type"===n[e]||"number"===typeof n[e]&&"@type"===n[e-1]?this.typeJobs.push({job:r,keys:n.slice(0,n.length-1)}):this.contextAwaitingJobs.push({job:r,keys:n});this.parsingContext.streamingProfile||0!==e||(this.lastOnValueJob=this.lastOnValueJob.then((()=>this.executeBufferedJobs())))}},this.jsonParser.onError=t=>{this.emit("error",t)}}isParsingContextInner(t){for(let e=t;e>0;e--)if("@context"===this.jsonParser.stack[e-1].key)return!0;return!1}async executeBufferedJobs(){for(const t of this.contextJobs)if(t)for(const e of t)await e();this.parsingContext.unaliasedKeywordCacheStack.splice(0);for(const t of this.contextAwaitingJobs){if(this.typeJobs.length>0){const e=[],n=[];for(let i=0;i<this.typeJobs.length;i++){const r=this.typeJobs[i];x.Util.isPrefixArray(r.keys,t.keys)&&(e.push(r),n.push(i))}const r=e.sort(((t,e)=>t.keys.length-e.keys.length));for(const t of r)await t.job();const a=n.sort().reverse();for(const t of a)this.typeJobs.splice(t,1)}await t.job()}}}e.JsonLdParser=m,m.DEFAULT_PROCESSING_MODE="1.1",m.ENTRY_HANDLERS=[new s.EntryHandlerArrayValue,new c.EntryHandlerKeywordContext,new h.EntryHandlerKeywordId,new p.EntryHandlerKeywordIncluded,new u.EntryHandlerKeywordGraph,new f.EntryHandlerKeywordNest,new g.EntryHandlerKeywordType,new C.EntryHandlerKeywordValue,new o.EntryHandlerContainer,new y.EntryHandlerKeywordUnknownFallback,new d.EntryHandlerPredicate,new l.EntryHandlerInvalidFallback]},82962:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParsingContext=void 0;const r=n(11288),a=n(87011),i=n(31434),s=n(99333);class o{constructor(t){this.contextParser=new r.ContextParser({documentLoader:t.documentLoader,skipValidation:t.skipContextValidation}),this.streamingProfile=!!t.streamingProfile,this.baseIRI=t.baseIRI,this.produceGeneralizedRdf=!!t.produceGeneralizedRdf,this.allowSubjectList=!!t.allowSubjectList,this.processingMode=t.processingMode||s.JsonLdParser.DEFAULT_PROCESSING_MODE,this.strictValues=!!t.strictValues,this.validateValueIndexes=!!t.validateValueIndexes,this.defaultGraph=t.defaultGraph,this.rdfDirection=t.rdfDirection,this.normalizeLanguageTags=t.normalizeLanguageTags,this.streamingProfileAllowOutOfOrderPlainType=t.streamingProfileAllowOutOfOrderPlainType,this.topLevelProperties=!1,this.activeProcessingMode=parseFloat(this.processingMode),this.processingStack=[],this.processingType=[],this.emittedStack=[],this.idStack=[],this.graphStack=[],this.graphContainerTermStack=[],this.listPointerStack=[],this.contextTree=new i.ContextTree,this.literalStack=[],this.validationStack=[],this.unaliasedKeywordCacheStack=[],this.jsonLiteralStack=[],this.unidentifiedValuesBuffer=[],this.unidentifiedGraphsBuffer=[],this.pendingContainerFlushBuffers=[],this.parser=t.parser,t.context?(this.rootContext=this.parseContext(t.context),this.rootContext.then((t=>this.validateContext(t)))):this.rootContext=Promise.resolve(new r.JsonLdContextNormalized(this.baseIRI?{"@base":this.baseIRI,"@__baseDocument":!0}:{}))}async parseContext(t,e,n){return this.contextParser.parse(t,{baseIRI:this.baseIRI,ignoreProtection:n,normalizeLanguageTags:this.normalizeLanguageTags,parentContext:e,processingMode:this.activeProcessingMode})}validateContext(t){const e=t.getContextRaw()["@version"];if(e){if(this.activeProcessingMode&&e>this.activeProcessingMode)throw new a.ErrorCoded(`Unsupported JSON-LD version '${e}' under active processing mode ${this.activeProcessingMode}.`,a.ERROR_CODES.PROCESSING_MODE_CONFLICT);if(this.activeProcessingMode&&e<this.activeProcessingMode)throw new a.ErrorCoded(`Invalid JSON-LD version ${e} under active processing mode ${this.activeProcessingMode}.`,a.ERROR_CODES.INVALID_VERSION_VALUE);this.activeProcessingMode=e}}async getContext(t,e=1){const n=t;while("number"===typeof t[t.length-1])t=t.slice(0,t.length-1);e&&(t=t.slice(0,-e));const a=await this.getContextPropagationAware(t),i=a.context;let s=i.getContextRaw();for(let o=a.depth;o<n.length-e;o++){const t=n[o],a=s[t];if(a&&"object"===typeof a&&"@context"in a){const i=(await this.parseContext(a,s,!0)).getContextRaw(),l=!(t in i)||i[t]["@context"]["@propagate"];!1===l&&o!==n.length-1-e||(s=i,delete s["@propagate"],s[t]=Object.assign({},s[t]),"@id"in a&&(s[t]["@id"]=a["@id"]),delete s[t]["@context"],!1!==l&&this.contextTree.setContext(n.slice(0,o+e),Promise.resolve(new r.JsonLdContextNormalized(s))))}}return new r.JsonLdContextNormalized(s)}async getContextPropagationAware(t){const e=t.length;let n,a=null;do{n=!1,a&&"@__propagateFallback"in a.context.getContextRaw()?a.context=new r.JsonLdContextNormalized(a.context.getContextRaw()["@__propagateFallback"]):(a&&(t=t.slice(0,a.depth-1)),a=await this.contextTree.getContext(t)||{context:await this.rootContext,depth:0});const e=t[t.length-1];if(e in a.context.getContextRaw()){const t=a.context.getContextRaw()[e];t&&"object"===typeof t&&"@context"in t&&(n=!0)}}while(a.depth>0&&!1===a.context.getContextRaw()["@propagate"]&&a.depth!==e&&!n);return 0===a.depth&&!1===a.context.getContextRaw()["@propagate"]&&a.depth!==e&&(a.context=new r.JsonLdContextNormalized({})),a}async newOnValueJob(t,e,n,r){await this.parser.newOnValueJob(t,e,n,r)}async handlePendingContainerFlushBuffers(){if(this.pendingContainerFlushBuffers.length>0){for(const t of this.pendingContainerFlushBuffers)await this.parser.flushBuffer(t.depth,t.keys),this.parser.flushStacks(t.depth);return this.pendingContainerFlushBuffers.splice(0,this.pendingContainerFlushBuffers.length),!0}return!1}emitQuad(t,e){1===t&&(this.topLevelProperties=!0),this.parser.push(e)}emitError(t){this.parser.emit("error",t)}emitContext(t){this.parser.emit("context",t)}getUnidentifiedValueBufferSafe(t){let e=this.unidentifiedValuesBuffer[t];return e||(e=[],this.unidentifiedValuesBuffer[t]=e),e}getUnidentifiedGraphBufferSafe(t){let e=this.unidentifiedGraphsBuffer[t];return e||(e=[],this.unidentifiedGraphsBuffer[t]=e),e}getExpandOptions(){return o.EXPAND_OPTIONS[this.activeProcessingMode]}shiftStack(t,e){const n=this.idStack[t+e];if(n&&(this.idStack[t]=n,this.emittedStack[t]=!0,delete this.idStack[t+e]),this.pendingContainerFlushBuffers.length)for(const r of this.pendingContainerFlushBuffers)r.depth>=t+e&&(r.depth-=e,r.keys.splice(t,e));this.unidentifiedValuesBuffer[t+e]&&(this.unidentifiedValuesBuffer[t]=this.unidentifiedValuesBuffer[t+e],delete this.unidentifiedValuesBuffer[t+e])}}e.ParsingContext=o,o.EXPAND_OPTIONS={1:{allowPrefixForcing:!1,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!1},1.1:{allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}},44360:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;const r=n(11288),a=n(41640),i=n(52780),s=n(95456);class o{constructor(t){this.parsingContext=t.parsingContext,this.dataFactory=t.dataFactory||new a.DataFactory,this.rdfFirst=this.dataFactory.namedNode(o.RDF+"first"),this.rdfRest=this.dataFactory.namedNode(o.RDF+"rest"),this.rdfNil=this.dataFactory.namedNode(o.RDF+"nil"),this.rdfType=this.dataFactory.namedNode(o.RDF+"type"),this.rdfJson=this.dataFactory.namedNode(o.RDF+"JSON")}static getContextValue(t,e,n,r){const a=t.getContextRaw()[n];if(!a)return r;const i=a[e];return void 0===i?r:i}static getContextValueContainer(t,e){return o.getContextValue(t,"@container",e,{"@set":!0})}static getContextValueType(t,e){const n=o.getContextValue(t,"@type",e,null);return"@none"===n?null:n}static getContextValueLanguage(t,e){return o.getContextValue(t,"@language",e,t.getContextRaw()["@language"]||null)}static getContextValueDirection(t,e){return o.getContextValue(t,"@direction",e,t.getContextRaw()["@direction"]||null)}static isContextValueReverse(t,e){return!!o.getContextValue(t,"@reverse",e,null)}static getContextValueIndex(t,e){return o.getContextValue(t,"@index",e,t.getContextRaw()["@index"]||null)}static isPropertyReverse(t,e,n){return"@reverse"===n!==o.isContextValueReverse(t,e)}static isValidIri(t){return null!==t&&r.Util.isValidIri(t)}static isPrefixArray(t,e){if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}async validateValueIndexes(t){if(this.parsingContext.validateValueIndexes){const e={};for(const n of t)if(n&&"object"===typeof n){const t=n["@id"],a=n["@index"];if(t&&a){const n=e[t];if(n&&n!==a)throw new r.ErrorCoded(`Conflicting @index value for ${t}`,r.ERROR_CODES.CONFLICTING_INDEXES);e[t]=a}}}}async valueToTerm(t,e,n,a,i){if("@json"===o.getContextValueType(t,e))return[this.dataFactory.literal(this.valueToJsonString(n),this.rdfJson)];const s=typeof n;switch(s){case"object":if(null===n||void 0===n)return[];if(Array.isArray(n))return"@list"in o.getContextValueContainer(t,e)?0===n.length?[this.rdfNil]:this.parsingContext.idStack[a+1]||[]:(await this.validateValueIndexes(n),[]);if(t=await this.getContextSelfOrPropertyScoped(t,e),"@context"in n&&(t=await this.parsingContext.parseContext(n["@context"],(await this.parsingContext.getContext(i,0)).getContextRaw())),n=await this.unaliasKeywords(n,i,a,t),"@value"in n){let s,o,l,d,c;for(e in n){const t=n[e];switch(e){case"@value":s=t;break;case"@language":o=t;break;case"@direction":l=t;break;case"@type":d=t;break;case"@index":c=t;break;default:throw new r.ErrorCoded(`Unknown value entry '${e}' in @value: ${JSON.stringify(n)}`,r.ERROR_CODES.INVALID_VALUE_OBJECT)}}if("@json"===await this.unaliasKeyword(d,i,a,!0,t))return[this.dataFactory.literal(this.valueToJsonString(s),this.rdfJson)];if(null===s)return[];if("object"===typeof s)throw new r.ErrorCoded(`The value of an '@value' can not be an object, got '${JSON.stringify(s)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT_VALUE);if(this.parsingContext.validateValueIndexes&&c&&"string"!==typeof c)throw new r.ErrorCoded(`The value of an '@index' must be a string, got '${JSON.stringify(c)}'`,r.ERROR_CODES.INVALID_INDEX_VALUE);if(o){if("string"!==typeof s)throw new r.ErrorCoded(`When an '@language' is set, the value of '@value' must be a string, got '${JSON.stringify(s)}'`,r.ERROR_CODES.INVALID_LANGUAGE_TAGGED_VALUE);if(!r.ContextParser.validateLanguage(o,this.parsingContext.strictValues,r.ERROR_CODES.INVALID_LANGUAGE_TAGGED_STRING))return[];(this.parsingContext.normalizeLanguageTags||1===this.parsingContext.activeProcessingMode)&&(o=o.toLowerCase())}if(l){if("string"!==typeof s)throw new Error(`When an '@direction' is set, the value of '@value' must be a string, got '${JSON.stringify(s)}'`);if(!r.ContextParser.validateDirection(l,this.parsingContext.strictValues))return[]}if(o&&l&&this.parsingContext.rdfDirection){if(d)throw new r.ErrorCoded(`Can not have '@language', '@direction' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(a,s,o,l))}if(o){if(d)throw new r.ErrorCoded(`Can not have both '@language' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return[this.dataFactory.literal(s,o)]}if(l&&this.parsingContext.rdfDirection){if(d)throw new r.ErrorCoded(`Can not have both '@direction' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(a,s,o,l))}if(d){if("string"!==typeof d)throw new r.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(d)}'`,r.ERROR_CODES.INVALID_TYPED_VALUE);const e=this.createVocabOrBaseTerm(t,d);if(!e)throw new r.ErrorCoded(`Invalid '@type' value, got '${JSON.stringify(d)}'`,r.ERROR_CODES.INVALID_TYPED_VALUE);if("NamedNode"!==e.termType)throw new r.ErrorCoded(`Illegal value type (${e.termType}): ${d}`,r.ERROR_CODES.INVALID_TYPED_VALUE);return[this.dataFactory.literal(s,e)]}return await this.valueToTerm(new r.JsonLdContextNormalized({}),e,s,a,i)}if("@set"in n){if(Object.keys(n).length>1)throw new r.ErrorCoded(`Found illegal neighbouring entries next to @set for key: '${e}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);return[]}if("@list"in n){if(Object.keys(n).length>1)throw new r.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${e}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);const t=n["@list"];return Array.isArray(t)?0===t.length?[this.rdfNil]:this.parsingContext.idStack[a+1]||[]:await this.valueToTerm(await this.parsingContext.getContext(i),e,t,a-1,i.slice(0,-1))}if("@reverse"in n&&"boolean"===typeof n["@reverse"])return[];if("@graph"in o.getContextValueContainer(await this.parsingContext.getContext(i),e)){const t=this.parsingContext.graphContainerTermStack[a+1];return t?Object.values(t):[this.dataFactory.blankNode()]}return"@id"in n?(Object.keys(n).length>1&&(t=await this.parsingContext.getContext(i,0)),"@context"in n&&(t=await this.parsingContext.parseContext(n["@context"],t.getContextRaw())),"@vocab"===n["@type"]?this.nullableTermToArray(this.createVocabOrBaseTerm(t,n["@id"])):this.nullableTermToArray(this.resourceToTerm(t,n["@id"]))):this.parsingContext.emittedStack[a+1]||n&&"object"===typeof n&&0===Object.keys(n).length?this.parsingContext.idStack[a+1]||(this.parsingContext.idStack[a+1]=[this.dataFactory.blankNode()]):[];case"string":return this.nullableTermToArray(this.stringValueToTerm(a,await this.getContextSelfOrPropertyScoped(t,e),e,n,null));case"boolean":return this.nullableTermToArray(this.stringValueToTerm(a,await this.getContextSelfOrPropertyScoped(t,e),e,Boolean(n).toString(),this.dataFactory.namedNode(o.XSD_BOOLEAN)));case"number":return this.nullableTermToArray(this.stringValueToTerm(a,await this.getContextSelfOrPropertyScoped(t,e),e,n,this.dataFactory.namedNode(n%1===0&&n<1e21?o.XSD_INTEGER:o.XSD_DOUBLE)));default:return this.parsingContext.emitError(new Error(`Could not determine the RDF type of a ${s}`)),[]}}async getContextSelfOrPropertyScoped(t,e){const n=t.getContextRaw()[e];return n&&"object"===typeof n&&"@context"in n&&(t=await this.parsingContext.parseContext(n,t.getContextRaw(),!0)),t}nullableTermToArray(t){return t?[t]:[]}predicateToTerm(t,e){const n=t.expandTerm(e,!0,this.parsingContext.getExpandOptions());return n?"_"===n[0]&&":"===n[1]?this.parsingContext.produceGeneralizedRdf?this.dataFactory.blankNode(n.substr(2)):null:o.isValidIri(n)?this.dataFactory.namedNode(n):n&&this.parsingContext.strictValues?(this.parsingContext.emitError(new r.ErrorCoded(`Invalid predicate IRI: ${n}`,r.ERROR_CODES.INVALID_IRI_MAPPING)),null):null:null}resourceToTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const n=t.expandTerm(e,!1,this.parsingContext.getExpandOptions());if(!o.isValidIri(n)){if(!n||!this.parsingContext.strictValues)return null;this.parsingContext.emitError(new Error(`Invalid resource IRI: ${n}`))}return this.dataFactory.namedNode(n)}createVocabOrBaseTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const n=this.parsingContext.getExpandOptions();let r=t.expandTerm(e,!0,n);if(r===e&&(r=t.expandTerm(e,!1,n)),!o.isValidIri(r)){if(!r||!this.parsingContext.strictValues||r.startsWith("@"))return null;this.parsingContext.emitError(new Error(`Invalid term IRI: ${r}`))}return this.dataFactory.namedNode(r)}intToString(t,e){if("number"===typeof t){if(Number.isFinite(t)){const n=t%1===0;return!n||e&&e.value===o.XSD_DOUBLE?t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"):Number(t).toString()}return t>0?"INF":"-INF"}return t}stringValueToTerm(t,e,n,r,a){const i=o.getContextValueType(e,n);if(i)if("@id"===i){if(!a)return this.resourceToTerm(e,this.intToString(r,a))}else if("@vocab"===i){if(!a)return this.createVocabOrBaseTerm(e,this.intToString(r,a))}else a=this.dataFactory.namedNode(i);if(!a){const i=o.getContextValueLanguage(e,n),s=o.getContextValueDirection(e,n);return s&&this.parsingContext.rdfDirection?this.createLanguageDirectionLiteral(t,this.intToString(r,a),i,s):this.dataFactory.literal(this.intToString(r,a),i)}return this.dataFactory.literal(this.intToString(r,a),a)}createLanguageDirectionLiteral(t,e,n,r){if("i18n-datatype"===this.parsingContext.rdfDirection)return n||(n=""),this.dataFactory.literal(e,this.dataFactory.namedNode(`https://www.w3.org/ns/i18n#${n}_${r}`));{const a=this.dataFactory.blankNode(),i=this.getDefaultGraph();return this.parsingContext.emitQuad(t,this.dataFactory.quad(a,this.dataFactory.namedNode(o.RDF+"value"),this.dataFactory.literal(e),i)),n&&this.parsingContext.emitQuad(t,this.dataFactory.quad(a,this.dataFactory.namedNode(o.RDF+"language"),this.dataFactory.literal(n),i)),this.parsingContext.emitQuad(t,this.dataFactory.quad(a,this.dataFactory.namedNode(o.RDF+"direction"),this.dataFactory.literal(r),i)),a}}valueToJsonString(t){return s(t)}async unaliasKeyword(t,e,n,a,i){if(Number.isInteger(t))return t;if(!a){const t=this.parsingContext.unaliasedKeywordCacheStack[n];if(t)return t}if(!r.Util.isPotentialKeyword(t)){i=i||await this.parsingContext.getContext(e);let n=i.getContextRaw()[t];n&&"object"===typeof n&&(n=n["@id"]),r.Util.isValidKeyword(n)&&(t=n)}return a?t:this.parsingContext.unaliasedKeywordCacheStack[n]=t}async unaliasKeywordParent(t,e){return await this.unaliasKeyword(e>0&&t[e-1],t,e-1)}async unaliasKeywords(t,e,n,r){const a={};for(const i in t)a[await this.unaliasKeyword(i,e,n+1,!0,r)]=t[i];return a}isLiteral(t){for(let e=t;e>=0;e--)if(this.parsingContext.literalStack[e]||this.parsingContext.jsonLiteralStack[e])return!0;return!1}async getDepthOffsetGraph(t,e){for(let n=t-1;n>0;n--)if("@graph"===await this.unaliasKeyword(e[n],e,n)){const r=(await i.EntryHandlerContainer.getContainerHandler(this.parsingContext,e,n)).containers;return i.EntryHandlerContainer.isComplexGraphContainer(r)?-1:t-n-1}return-1}validateReverseSubject(t){if("Literal"===t.termType)throw new r.ErrorCoded(`Found illegal literal in subject position: ${t.value}`,r.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}getDefaultGraph(){return this.parsingContext.defaultGraph||this.dataFactory.defaultGraph()}async getGraphContainerValue(t,e){let n=this.getDefaultGraph();const{containers:r,depth:a}=await i.EntryHandlerContainer.getContainerHandler(this.parsingContext,t,e);if("@graph"in r){const e=i.EntryHandlerContainer.getContainerGraphIndex(r,a,t),s=this.parsingContext.graphContainerTermStack[a];if(n=s?s[e]:null,!n){let i=null;if("@id"in r){const e=await this.getContainerKey(t[a],t,a);null!==e&&(i=await this.resourceToTerm(await this.parsingContext.getContext(t),e))}i||(i=this.dataFactory.blankNode()),this.parsingContext.graphContainerTermStack[a]||(this.parsingContext.graphContainerTermStack[a]={}),n=this.parsingContext.graphContainerTermStack[a][e]=i}}return n}async getPropertiesDepth(t,e){let n=e;for(let r=e-1;r>0;r--)if("number"!==typeof t[r]){const e=await this.unaliasKeyword(t[r],t,r);if("@reverse"===e)return r;if("@nest"!==e)return n;n=r}return n}async getContainerKey(t,e,n){const r=await this.unaliasKeyword(t,e,n);return"@none"===r?null:r}}e.Util=o,o.XSD="http://www.w3.org/2001/XMLSchema#",o.XSD_BOOLEAN=o.XSD+"boolean",o.XSD_INTEGER=o.XSD+"integer",o.XSD_DOUBLE=o.XSD+"double",o.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#"},15269:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIdentifier=void 0;class n{canCombineWithGraph(){return!0}async handle(t,e,n,r,a,i){let s;if(e.emittedStack[i+1]&&e.idStack[i+1])s=e.idStack[i+1][0];else{const t=await n.getContainerKey(r[i],r,i),a=null!==t?await n.resourceToTerm(await e.getContext(r),r[i]):n.dataFactory.blankNode();if(!a)return void(e.emittedStack[i]=!1);s=a,e.idStack[i+1]=[s]}let o=e.idStack[i];o||(o=e.idStack[i]=[]),o.some((t=>t.equals(s)))||o.push(s),await e.handlePendingContainerFlushBuffers()||(e.emittedStack[i]=!1)}}e.ContainerHandlerIdentifier=n},3039:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIndex=void 0;const r=n(11288),a=n(37930),i=n(44360);class s{canCombineWithGraph(){return!0}async handle(t,e,n,s,o,l){if(!Array.isArray(o)){const d="@graph"in t,c=await e.getContext(s),u=s[l-1],h=i.Util.getContextValueIndex(c,u);if(h){if(r.Util.isPotentialKeyword(h))throw new r.ErrorCoded(`Keywords can not be used as @index value, got: ${h}`,r.ERROR_CODES.INVALID_TERM_DEFINITION);if("string"!==typeof h)throw new r.ErrorCoded(`@index values must be strings, got: ${h}`,r.ERROR_CODES.INVALID_TERM_DEFINITION);if("object"!==typeof o){if("@id"!==i.Util.getContextValueType(c,u))throw new r.ErrorCoded(`Property-based index containers require nodes as values or strings with @type: @id, but got: ${o}`,r.ERROR_CODES.INVALID_VALUE_OBJECT);const t=n.resourceToTerm(c,o);t&&(e.idStack[l+1]=[t])}const t=n.createVocabOrBaseTerm(c,h);if(t){const r=await n.valueToTerm(c,h,await n.getContainerKey(s[l],s,l),l,s);if(d){const a=await n.getGraphContainerValue(s,l+1);for(const i of r)e.emitQuad(l,n.dataFactory.quad(a,t,i,n.getDefaultGraph()))}else for(const i of r)await a.EntryHandlerPredicate.handlePredicateObject(e,n,s,l+1,t,i,!1)}}const p=d?2:1;await e.newOnValueJob(s.slice(0,s.length-p),o,l-p,!0),await e.handlePendingContainerFlushBuffers()}e.emittedStack[l]=!1}}e.ContainerHandlerIndex=s},68681:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerLanguage=void 0;const r=n(11288);class a{canCombineWithGraph(){return!1}async handle(t,e,n,a,i,s){const o=await n.getContainerKey(a[s],a,s);if(Array.isArray(i))i=i.map((t=>({"@value":t,"@language":o})));else{if("string"!==typeof i)throw new r.ErrorCoded(`Got invalid language map value, got '${JSON.stringify(i)}', but expected string`,r.ERROR_CODES.INVALID_LANGUAGE_MAP_VALUE);i={"@value":i,"@language":o}}await e.newOnValueJob(a.slice(0,a.length-1),i,s-1,!0),e.emittedStack[s]=!1}}e.ContainerHandlerLanguage=a},49408:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerType=void 0;const r=n(37930),a=n(44360);class i{canCombineWithGraph(){return!1}async handle(t,e,n,i,s,o){if(!Array.isArray(s)){if("string"===typeof s){const t=await e.getContext(i),r=a.Util.getContextValueType(t,i[o-1]),l="@vocab"===r?await n.createVocabOrBaseTerm(t,s):await n.resourceToTerm(t,s);if(l){const t={"@id":"NamedNode"===l.termType?l.value:s};await e.newOnValueJob(i.slice(0,i.length-1),t,o-1,!0),e.idStack[o+1]=[l]}}else{const t=!!e.idStack[o+1];t||delete e.idStack[o],await e.newOnValueJob(i.slice(0,i.length-1),s,o-1,!0),t||(e.idStack[o+1]=e.idStack[o])}const t=await n.getContainerKey(i[o],i,o),l=null!==t?n.createVocabOrBaseTerm(await e.getContext(i),t):null;l&&await r.EntryHandlerPredicate.handlePredicateObject(e,n,i,o+1,n.rdfType,l,!1),await e.handlePendingContainerFlushBuffers()}e.emittedStack[o]=!1}}e.ContainerHandlerType=i},27765:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerArrayValue=void 0;const r=n(44360);class a{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,a){return this.test(t,e,null,n,r)}async test(t,e,n,r,a){return"number"===typeof r[a]}async handle(t,e,n,a,i,s){let o=await e.unaliasKeywordParent(a,s);if("@list"===o){let n=null,r=0;for(let t=s-2;t>0;t--){const e=a[t];if("string"===typeof e||"number"===typeof e){r=t,n=e;break}}if(null!==n){const o=await e.valueToTerm(await t.getContext(a),n,i,s,a);for(const n of o)await this.handleListElement(t,e,n,i,s,a.slice(0,r),r);0===o.length&&await this.handleListElement(t,e,null,i,s,a.slice(0,r),r)}}else if("@set"===o)await t.newOnValueJob(a.slice(0,-2),i,s-2,!1);else if(void 0!==o&&"@type"!==o){for(let t=s-1;t>0;t--)if("number"!==typeof a[t]){o=await e.unaliasKeyword(a[t],a,t);break}const n=await t.getContext(a.slice(0,-1));if("@list"in r.Util.getContextValueContainer(n,o)){t.emittedStack[s+1]=!0;const n=await e.valueToTerm(await t.getContext(a),o,i,s,a);for(const r of n)await this.handleListElement(t,e,r,i,s,a.slice(0,-1),s-1);0===n.length&&await this.handleListElement(t,e,null,i,s,a.slice(0,-1),s-1)}else t.shiftStack(s,1),await t.newOnValueJob(a.slice(0,-1),i,s-1,!1),t.contextTree.removeContext(a.slice(0,-1))}}async handleListElement(t,e,n,r,a,i,s){let o=t.listPointerStack[a];if(null!==r&&null!==(await e.unaliasKeywords(r,i,a))["@value"]){if(o&&o.value){const n=e.dataFactory.blankNode();t.emitQuad(a,e.dataFactory.quad(o.value,e.rdfRest,n,e.getDefaultGraph())),o.value=n}else{const t=e.dataFactory.blankNode();o={value:t,listRootDepth:s,listId:t}}n&&t.emitQuad(a,e.dataFactory.quad(o.value,e.rdfFirst,n,e.getDefaultGraph()))}else o||(o={listRootDepth:s,listId:e.rdfNil});t.listPointerStack[a]=o}}e.EntryHandlerArrayValue=a},52780:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerContainer=void 0;const r=n(15269),a=n(3039),i=n(68681),s=n(49408),o=n(44360);class l{static isSimpleGraphContainer(t){return"@graph"in t&&("@set"in t&&2===Object.keys(t).length||1===Object.keys(t).length)}static isComplexGraphContainer(t){return"@graph"in t&&("@set"in t&&Object.keys(t).length>2||!("@set"in t)&&Object.keys(t).length>1)}static getContainerGraphIndex(t,e,n){let r=l.isSimpleGraphContainer(t),a="";for(let i=e;i<n.length;i++)r&&"number"!==typeof n[i]||(a+=":"+n[i]),r||"number"===typeof n[i]||(r=!0);return a}static async getContainerHandler(t,e,n){const r={containers:{"@set":!0},depth:n,fallback:!0};let a=!1;const i=await t.getContext(e,2);for(let s=n-1;s>=0;s--)if("number"!==typeof e[s]){const t=o.Util.getContextValue(i,"@container",e[s],!1);if(t&&l.isSimpleGraphContainer(t))return{containers:t,depth:s+1,fallback:!1};const n=o.Util.getContextValue(i,"@container",e[s-1],!1);if(n){const t="@graph"in n;for(const e in l.CONTAINER_HANDLERS)if(n[e])return t?l.CONTAINER_HANDLERS[e].canCombineWithGraph()?{containers:n,depth:s,fallback:!1}:r:a?r:{containers:n,depth:s,fallback:!1};return r}if(a)return r;a=!0}return r}static async isBufferableContainerHandler(t,e,n){const r=await l.getContainerHandler(t,e,n);return!r.fallback&&!("@graph"in r.containers)}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,a){return!!await this.test(t,e,null,n,r)}async test(t,e,n,r,a){const i=o.Util.getContextValueContainer(await t.getContext(r,2),r[a-1]);for(const s in l.CONTAINER_HANDLERS)if(i[s])return{containers:i,handler:l.CONTAINER_HANDLERS[s]};return null}async handle(t,e,n,r,a,i,s){return s.handler.handle(s.containers,t,e,r,a,i)}}e.EntryHandlerContainer=l,l.CONTAINER_HANDLERS={"@id":new r.ContainerHandlerIdentifier,"@index":new a.ContainerHandlerIndex,"@language":new i.ContainerHandlerLanguage,"@type":new s.ContainerHandlerType}},52234:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerInvalidFallback=void 0;class n{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,a){return!1}async test(t,e,n,r,a){return!0}async handle(t,e,n,r,a,i){t.emittedStack[i]=!1}}e.EntryHandlerInvalidFallback=n},37930:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerPredicate=void 0;const r=n(11288),a=n(44360);class i{static async handlePredicateObject(t,e,n,r,a,i,s){const o=await e.getPropertiesDepth(n,r),l=await e.getDepthOffsetGraph(r,n),d=r-l,c=t.idStack[o];if(c)for(const u of c){const c=l>=0;if(c){const n=t.idStack[d-1];if(n)for(const o of n)s?(e.validateReverseSubject(i),t.emitQuad(r,e.dataFactory.quad(i,a,u,o))):t.emitQuad(r,e.dataFactory.quad(u,a,i,o));else s?(e.validateReverseSubject(i),t.getUnidentifiedGraphBufferSafe(d-1).push({subject:i,predicate:a,object:u})):t.getUnidentifiedGraphBufferSafe(d-1).push({subject:u,predicate:a,object:i})}else{const l=await e.getGraphContainerValue(n,o);s?(e.validateReverseSubject(i),t.emitQuad(r,e.dataFactory.quad(i,a,u,l))):t.emitQuad(r,e.dataFactory.quad(u,a,i,l))}}else s&&e.validateReverseSubject(i),t.getUnidentifiedValueBufferSafe(o).push({predicate:a,object:i,reverse:s})}isPropertyHandler(){return!0}isStackProcessor(){return!0}async validate(t,e,n,r,i){const s=n[r];if(s){const i=await t.getContext(n);if(!t.jsonLiteralStack[r]&&await e.predicateToTerm(i,n[r]))return"@json"===a.Util.getContextValueType(i,s)&&(t.jsonLiteralStack[r+1]=!0),!0}return!1}async test(t,e,n,r,a){return r[a]}async handle(t,e,n,s,o,l,d){const c=s[l],u=await t.getContext(s),h=await e.predicateToTerm(u,n);if(h){const d=await e.valueToTerm(u,n,o,l,s);if(d.length)for(let p of d){const d=a.Util.isPropertyReverse(u,c,await e.unaliasKeywordParent(s,l));if(o){const i="@list"in a.Util.getContextValueContainer(u,n);if(i||o["@list"]){if((i&&!Array.isArray(o)&&!o["@list"]||o["@list"]&&!Array.isArray(o["@list"]))&&p!==e.rdfNil){const n=e.dataFactory.blankNode();t.emitQuad(l,e.dataFactory.quad(n,e.rdfRest,e.rdfNil,e.getDefaultGraph())),t.emitQuad(l,e.dataFactory.quad(n,e.rdfFirst,p,e.getDefaultGraph())),p=n}if(d&&!t.allowSubjectList)throw new r.ErrorCoded(`Found illegal list value in subject position at ${n}`,r.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}}await i.handlePredicateObject(t,e,s,l,h,p,d)}}}}e.EntryHandlerPredicate=i},66854:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeyword=void 0;class n{constructor(t){this.keyword=t}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,r,a){return!1}async test(t,e,n,r,a){return n===this.keyword}}e.EntryHandlerKeyword=n},70983:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordContext=void 0;const r=n(11288),a=n(66854);class i extends a.EntryHandlerKeyword{constructor(){super("@context")}isStackProcessor(){return!1}async handle(t,e,n,a,i,s){t.streamingProfile&&(t.processingStack[s]||t.processingType[s]||void 0!==t.idStack[s])&&t.emitError(new r.ErrorCoded("Found an out-of-order context, while streaming is enabled.(disable `streamingProfile`)",r.ERROR_CODES.INVALID_STREAMING_KEY_ORDER));const o=t.getContext(a),l=t.parseContext(i,(await o).getContextRaw());t.contextTree.setContext(a.slice(0,-1),l),t.emitContext(i),await t.validateContext(await l)}}e.EntryHandlerKeywordContext=i},42397:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordGraph=void 0;const r=n(66854);class a extends r.EntryHandlerKeyword{constructor(){super("@graph")}async handle(t,e,n,r,a,i){t.graphStack[i+1]=!0}}e.EntryHandlerKeywordGraph=a},96700:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordId=void 0;const r=n(11288),a=n(66854);class i extends a.EntryHandlerKeyword{constructor(){super("@id")}isStackProcessor(){return!1}async handle(t,e,n,a,i,s){"string"!==typeof i&&t.emitError(new r.ErrorCoded(`Found illegal @id '${i}'`,r.ERROR_CODES.INVALID_ID_VALUE));const o=await e.getPropertiesDepth(a,s);void 0!==t.idStack[o]&&(t.idStack[o][0].listHead?t.emitError(new r.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${a[s-1]}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT)):t.emitError(new r.ErrorCoded(`Found duplicate @ids '${t.idStack[o][0].value}' and '${i}'`,r.ERROR_CODES.COLLIDING_KEYWORDS))),t.idStack[o]=e.nullableTermToArray(await e.resourceToTerm(await t.getContext(a),i))}}e.EntryHandlerKeywordId=i},26664:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordIncluded=void 0;const r=n(11288),a=n(66854);class i extends a.EntryHandlerKeyword{constructor(){super("@included")}async handle(t,e,n,a,i,s){"object"!==typeof i&&t.emitError(new r.ErrorCoded(`Found illegal @included '${i}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE));const o=await e.unaliasKeywords(i,a,s,await t.getContext(a));"@value"in o&&t.emitError(new r.ErrorCoded(`Found an illegal @included @value node '${JSON.stringify(i)}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE)),"@list"in o&&t.emitError(new r.ErrorCoded(`Found an illegal @included @list node '${JSON.stringify(i)}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE)),t.emittedStack[s]=!1}}e.EntryHandlerKeywordIncluded=i},84149:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordNest=void 0;const r=n(11288),a=n(66854);class i extends a.EntryHandlerKeyword{constructor(){super("@nest")}async handle(t,e,n,a,i,s){"object"!==typeof i&&t.emitError(new r.ErrorCoded(`Found invalid @nest entry for '${n}': '${i}'`,r.ERROR_CODES.INVALID_NEST_VALUE)),"@value"in await e.unaliasKeywords(i,a,s,await t.getContext(a))&&t.emitError(new r.ErrorCoded(`Found an invalid @value node for '${n}'`,r.ERROR_CODES.INVALID_NEST_VALUE)),t.emittedStack[s]=!1}}e.EntryHandlerKeywordNest=i},46100:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordType=void 0;const r=n(11288),a=n(44360),i=n(37930),s=n(66854);class o extends s.EntryHandlerKeyword{constructor(){super("@type")}isStackProcessor(){return!1}async handle(t,e,n,s,o,l){const d=s[l],c=await t.getContext(s),u=e.rdfType,h=a.Util.isPropertyReverse(c,d,await e.unaliasKeywordParent(s,l)),p=Array.isArray(o)?o:[o];for(const a of p){"string"!==typeof a&&t.emitError(new r.ErrorCoded(`Found illegal @type '${a}'`,r.ERROR_CODES.INVALID_TYPE_VALUE));const n=e.createVocabOrBaseTerm(c,a);n&&await i.EntryHandlerPredicate.handlePredicateObject(t,e,s,l,u,n,h)}let f=Promise.resolve(c),g=!1;for(const r of p.sort()){const e=a.Util.getContextValue(c,"@context",r,null);e&&(g=!0,f=f.then((n=>t.parseContext(e,n.getContextRaw()))))}!t.streamingProfile||!g&&t.streamingProfileAllowOutOfOrderPlainType||!t.processingStack[l]&&!t.idStack[l]||t.emitError(new r.ErrorCoded("Found an out-of-order type-scoped context, while streaming is enabled.(disable `streamingProfile`)",r.ERROR_CODES.INVALID_STREAMING_KEY_ORDER)),g&&(f=f.then((t=>("@propagate"in t.getContextRaw()||(t.getContextRaw()["@propagate"]=!1),!1===t.getContextRaw()["@propagate"]&&(t.getContextRaw()["@__propagateFallback"]=c.getContextRaw()),t))),t.contextTree.setContext(s.slice(0,s.length-1),f)),t.processingType[l]=!0}}e.EntryHandlerKeywordType=o},65457:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordUnknownFallback=void 0;const r=n(11288);class a{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,a,i){const s=await e.unaliasKeyword(n[a],n,a);return!!r.Util.isPotentialKeyword(s)&&!(!i&&"@list"===s)}async test(t,e,n,a,i){return r.Util.isPotentialKeyword(n)}async handle(t,e,n,i,s,o){const l=a.VALID_KEYWORDS_TYPES[n];void 0!==l?l&&typeof s!==l.type&&t.emitError(new r.ErrorCoded(`Invalid value type for '${n}' with value '${s}'`,l.errorCode)):t.strictValues&&t.emitError(new Error(`Unknown keyword '${n}' with value '${s}'`)),t.emittedStack[o]=!1}}e.EntryHandlerKeywordUnknownFallback=a,a.VALID_KEYWORDS_TYPES={"@index":{type:"string",errorCode:r.ERROR_CODES.INVALID_INDEX_VALUE},"@list":null,"@reverse":{type:"object",errorCode:r.ERROR_CODES.INVALID_REVERSE_VALUE},"@set":null,"@value":null}},18896:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordValue=void 0;const r=n(66854);class a extends r.EntryHandlerKeyword{constructor(){super("@value")}async validate(t,e,n,r,a){const i=n[r];return i&&!t.literalStack[r]&&await this.test(t,e,i,n,r)&&(t.literalStack[r]=!0),super.validate(t,e,n,r,a)}async test(t,e,n,r,a){return"@value"===await e.unaliasKeyword(r[a],r.slice(0,r.length-1),a-1,!0)}async handle(t,e,n,r,a,i){t.literalStack[i]=!0,delete t.unidentifiedValuesBuffer[i],delete t.unidentifiedGraphsBuffer[i],t.emittedStack[i]=!1}}e.EntryHandlerKeywordValue=a}}]);
//# sourceMappingURL=246.d6c4ddc5.js.map