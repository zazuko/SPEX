{"version":3,"file":"js/9.66b2bd1c.js","mappings":"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","sources":["webpack://@zazuko/spex/./src/views/ShaclEditor.vue","webpack://@zazuko/spex/./src/views/ShaclEditor.vue?a28c"],"sourcesContent":["<template>\n  <Splitpanes class=\"default-theme\">\n    <Pane size=\"40\">\n      <h2 class=\"font-bold text-lg px-4 py-2 bg-gray-200\">SHACL editor</h2>\n      <rdf-editor class=\"w-full h-full overflow-hidden\" :format=\"format\" :value=\"shacl\" ref=\"shaclEditor\" />\n      <div class=\"field\">\n        <label class=\"label\" for=\"format\">Format</label>\n        <div class=\"select\">\n          <select id=\"format\" v-model=\"format\">\n            <option v-for=\"format in formats\" :key=\"format\" :value=\"format\">\n              {{ format }}\n            </option>\n          </select>\n        </div>\n      </div>\n      <button class=\"button is-primary\" @click=\"loadShacl\">\n        <ArrowPathIcon class=\"icon\" />\n        <span>Update</span>\n      </button>\n    </Pane>\n    <Pane>\n      <Splitpanes horizontal>\n        <Pane>\n          <div class=\"flex-grow flex flex-col\">\n            <h2 class=\"font-bold text-lg px-4 py-2 bg-gray-200\">Representation</h2>\n\n            <GraphLayout :nodes=\"datamodel.tables\" :links=\"links\" :active-links=\"activeLinks\">\n              <template v-slot:node=\"{ node }\">\n                <ResourceCard :resource=\"node\" :active-links=\"activeLinks\" />\n              </template>\n            </GraphLayout>\n\n            <div class=\"section\" v-if=\"error\">\n              <div class=\"message is-danger\">\n                <div class=\"message-body\">\n                  Error loading data: {{ error }}\n                </div>\n              </div>\n            </div>\n          </div>\n        </Pane>\n      </Splitpanes>\n    </Pane>\n  </Splitpanes>\n</template>\n\n<script>\nimport { ArrowPathIcon } from '@heroicons/vue/24/solid'\nimport { shrink as _shrink } from '@zazuko/prefixes'\nimport { GraphLayout } from '@zazuko/vue-graph-layout'\nimport { Splitpanes, Pane } from 'splitpanes'\nimport 'splitpanes/dist/splitpanes.css'\nimport '@rdfjs-elements/rdf-editor'\nimport rdfEnvironment from '@zazuko/env/web'\nimport { tablesFromSHACL } from '@/shacl'\nimport { rdf, sh } from '@/namespace'\nimport ResourceCard from '@/components/ResourceCard.vue'\n\nconst formats = [...parsers.keys()]\n\nconst initialEditorContent = `\n@prefix sh: <http://www.w3.org/ns/shacl#> .\n@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .\n`\n\nexport default {\n  components: {\n    GraphLayout,\n    Splitpanes,\n    Pane,\n    ArrowPathIcon,\n    ResourceCard,\n  },\n\n  data() {\n    return {\n      format: 'text/turtle',\n      formats,\n      shacl: initialEditorContent,\n      datamodel: {\n        tables: [],\n        viewports: [],\n        isIntrospected: false,\n      },\n      error: null,\n      activeLinks: [],\n    }\n  },\n\n  computed: {\n    links() {\n      const tables = this.datamodel.tables\n      const tableIds = new Set(tables.map(({ id }) => id))\n      return tables\n        .flatMap(table => table.properties.map((property) => ({ ...property, table })))\n        .reduce((acc, property) => {\n          property.values.forEach((value) => {\n            const source = property.table.id\n            const target = value.id\n            if (tableIds.has(target)) {\n              acc.push({ source, target, sourceProperty: property.id, label: property.name })\n            }\n          })\n\n          return acc\n        }, [])\n    },\n  },\n\n  methods: {\n    async loadShacl() {\n      const editor = this.$refs.shaclEditor\n\n      this.error = null\n      this.datamodel.tables = []\n\n      const shrink = (uri) => _shrink(uri) || uri\n\n      try {\n        const quads = await editor.quads\n        const dataset = rdfEnvironment.dataset(quads)\n        const shapes = rdfEnvironment.clownface({ dataset }).has(rdf.type, sh.NodeShape)\n        this.datamodel.tables = tablesFromSHACL(shapes, shrink)\n      } catch (e) {\n        this.error = e.toString()\n      }\n    }\n  }\n}\n</script>\n","import { render } from \"./ShaclEditor.vue?vue&type=template&id=5108d189\"\nimport script from \"./ShaclEditor.vue?vue&type=script&lang=js\"\nexport * from \"./ShaclEditor.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","class","for","_createBlock","_component_Splitpanes","_createVNode","_component_Pane","size","_hoisted_1","_component_rdf_editor","format","$data","value","shacl","ref","_hoisted_2","_hoisted_3","_hoisted_4","id","$event","_createElementBlock","_Fragment","_renderList","formats","key","_hoisted_5","onClick","_cache","args","$options","loadShacl","_component_ArrowPathIcon","_hoisted_6","horizontal","_hoisted_7","_hoisted_8","_component_GraphLayout","nodes","datamodel","tables","links","activeLinks","node","_withCtx","_component_ResourceCard","resource","error","_hoisted_9","_hoisted_10","_hoisted_11","_toDisplayString","parsers","keys","initialEditorContent","components","GraphLayout","Splitpanes","Pane","ArrowPathIcon","ResourceCard","data","viewports","isIntrospected","computed","this","tableIds","Set","map","flatMap","table","properties","property","reduce","acc","values","forEach","source","target","has","push","sourceProperty","label","name","methods","async","editor","$refs","shaclEditor","shrink","uri","_shrink","quads","dataset","rdfEnvironment","shapes","clownface","rdf","type","sh","NodeShape","tablesFromSHACL","e","toString","__exports__","render"],"sourceRoot":""}